# 🚀 快速测试指南

## 问题诊断

你遇到的错误是：
```
{"code":500,"message":"Cannot read properties of undefined (reading 'length')","collection":undefined}
```

这说明参数没有正确传递。

---

## ✅ 解决方案

### 第1步：重新上传云函数

我已经修复了云函数，添加了更好的参数验证。

**操作**：
1. 在 HBuilderX 中找到 `data-import` 云函数
2. **右键** → **上传云函数**
3. 等待上传成功

---

### 第2步：测试导入（用小数据测试）

我创建了一个测试文件 `test-import.json`（只有1条数据），先用它测试。

**操作**：
1. 右键 `data-import` → **云端运行**（不是"运行本地云函数"）
2. 在弹出的参数框中，粘贴以下内容：

```json
{
  "collection": "cities",
  "data": [
    {
      "_id": 999,
      "name": "测试城市",
      "code": "test",
      "is_active": true,
      "created_at": 1700000000000,
      "updated_at": 1700000000000
    }
  ],
  "clearBefore": false
}
```

3. 点击"运行"
4. 查看结果

---

## 🔍 如果还是报错

### 可能原因 1：选错了运行方式

**问题**：你可能点了"运行本地云函数"  
**解决**：应该选择 **"云端运行"** 或 **"运行云函数"**

### 可能原因 2：参数框是空的

**问题**：没有粘贴参数就点了运行  
**解决**：必须先粘贴完整的 JSON 参数，再点运行

### 可能原因 3：JSON 格式错误

**问题**：复制的内容不完整  
**解决**：
- 确保复制了从 `{` 到 `}` 的完整内容
- 可以先在记事本中打开，Ctrl+A 全选，再复制

---

## 📝 正确的操作步骤图示

```
1. 在 HBuilderX 项目树中找到：
   uniCloud-aliyun/cloudfunctions/data-import

2. 右键 data-import 文件夹（注意是文件夹，不是 index.js）

3. 在菜单中找到：
   ❌ 运行本地云函数 (不选这个)
   ✅ 云端运行 (选这个)
   或
   ✅ 运行云函数 (选这个)

4. 弹出对话框，有一个大的文本输入框

5. 在输入框中粘贴 JSON 参数

6. 点击"运行"按钮

7. 底部控制台显示结果
```

---

## 🎯 成功的标志

如果成功，控制台会显示类似这样的信息：

```
[云端运行:阿里云:tangzai]运行状态：成功
[云端运行:阿里云:tangzai]运行结果：{
  "code": 0,
  "message": "数据导入完成",
  "collection": "cities",
  "total": 1,
  "inserted": 1,
  "failed": 0
}
```

---

## 📞 如果修复后的云函数还是报错

新的云函数会提供更详细的错误信息，告诉你：
- 接收到了什么参数
- 缺少哪个字段
- 参数格式是否正确

把完整的错误信息发给我，我帮你分析。

---

**先测试这1条数据，成功后再导入大批量数据！** 🚀
